<!DOCTYPE html>
<html>
  <head>
    <title>Add a New Product</title>
    <link rel="stylesheet" href="/css/root.css" />
    <link rel="stylesheet" href="/css/dashboard2.css" />
    <link rel="stylesheet" href="/css/createProduct.css" />
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css"
    />
  </head>

  <body style="position: relative">
    <nav >
      <div style="height: 71px;">
        <h3 style="padding: 10px;">Khắc Huy Shop</h3>
      </div>
      <div class="nav-item" style="border-top: 1px solid #ccc;border-bottom: none;">
        <ul id="route"></ul>
      </div>
    </nav>

    <main style="height: 100%;">
      <div style="display: flex;justify-content: space-between; height: 70px;">
        <div>
          <h3 id="page" style="margin: auto 0;padding: 10px;">Tiêu đề trang</h3>
        </div>
        <div style="margin-right: 40px;display: flex;">
          <h4 style="margin: 15px;">Admin</h4>
          <img style="border-radius: 100%; margin-left: 4px;"
            src="https://th.bing.com/th?id=OIP.aRRBXrcRda7kFmPMlPnCTQHaFj&w=288&h=216&c=8&rs=1&qlt=90&o=6&dpr=1.3&pid=3.1&rm=2"
            height="45" width="45" alt="">
        </div>
      </div>
      <div class="containerBox main-item" style="border-bottom: none; margin-bottom: 80px;" >
          <div class="">
            <form
            id="HandleSubmitForm"
            enctype="multipart/form-data"
            style="margin-left: 10px"
          >
            <div class="card" style="width: 95%; margin: auto">
              <div style="display: flex; justify-content: center">
                <div style="width: 200px">
                  <div class="form-group">
                    <label for="name"
                      >Tên sách<strong style="color: red">*</strong></label
                    >
                  </div>
                  <div class="form-group">
                    <label for="barCode"
                      >Mã sách<strong style="color: red">*</strong></label
                    >
                  </div>
                  <div class="form-group">
                    <label for="priceImport"
                      >Giá nhập<strong style="color: red">*</strong></label
                    >
                  </div>
                  <div class="form-group">
                    <label for="priceSelling" style="padding-top: 10px"
                      >Giá bán<strong style="color: red">*</strong></label
                    >
                  </div>
                  <div class="form-group">
                    <label for="weight"
                      >Số trang<strong style="color: red">*</strong></label
                    >
                  </div>
                  <div class="form-group">
                    <label for="quantity"
                      >Số lượng<strong style="color: red">*</strong></label
                    >
                  </div>
                  <div class="form-group">
                    <label
                      for="categoryId"
                      style="white-space: break-spaces; padding-top: 10px"
                      >Danh mục<strong style="color: red">*</strong></label
                    >
                  </div>
                  <div class="form-group">
                    <label for="image"
                      >Ảnh sách<strong style="color: red">*</strong></label
                    >
                  </div>
                  <div class="form-group">
                    <label for="description"
                      >Mô tả<strong style="color: red">*</strong></label
                    >
                  </div>
                  <div class="form-group"></div>
                </div>
                <div style="width: 95%">
                  <div class="form-group">
                    <input
                      type="text"
                      id="name"
                      name="name"
                      required
                      placeholder="Tên sách"
                    />
                  </div>
                  <div class="form-group">
                    <input
                      type="text"
                      id="barCode"
                      name="barCode"
                      required
                      placeholder="Mã sách"
                    />
                  </div>
                  <div class="form-group">
                    <input
                      type="number"
                      id="priceImport"
                      name="priceImport"
                      min="0"
                      step="0.01"
                      required
                      placeholder="Giá nhập"
                    />
                  </div>
                  <div class="form-group">
                    <input
                      type="number"
                      id="priceSelling"
                      name="priceSelling"
                      min="0"
                      step="0.01"
                      required
                      placeholder="Giá bán"
                    />
                  </div>
                  <div class="form-group">
                    <input
                      type="number"
                      id="weight"
                      name="weight"
                      min="0"
                      step="0.01"
                      required
                      placeholder="Số trang"
                    />
                  </div>
                  <div class="form-group">
                    <input
                      type="number"
                      id="quantity"
                      name="quantity"
                      min="0"
                      required
                      placeholder="Số lượng"
                    />
                  </div>
                  <div class="form-group">
                    <select
                      name="categoryId"
                      style="width: 100%"
                      id="categoryId"
                      required
                      placeholder="Danh mục"
                    ></select>
                  </div>
                  <div class="form-group">
                    <input
                      style="padding: 10px 0"
                      type="file"
                      id="image"
                      name="image"
                      accept="image/*"
                      multiple
                      required
                    />
                  </div>
                  <div class="form-group">
                    <textarea
                      id="description"
                      name="description"
                      rows="4"
                    ></textarea>
                  </div>
                  <div class="form-group">
                    <button
                      type="submit"
                      class="addproduct"
                      style="background-color: var(--prymary-color)"
                    >
                      Thêm ngay
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </form>
          </div>
  
      </div>
    </main>
    
  </body>
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

  <script
    type="text/javascript"
    src="https://cdn.jsdelivr.net/npm/toastify-js"
  ></script>
  <script src="/js/route.js"></script>
  <script>
    let html = route.map((e, index) => {
      const pathname = window.location.pathname;
      if (e.href == pathname) {
        return `<li class="active"><a href="${e.href}">${e.text}</a></li>`;
      } else {
        return `<li><a href="${e.href}">${e.text}</a></li>`;
      }
    });
    $("#route")[0].innerHTML = html.join("");
    $("#page").text($("#route>.active")[0].innerText)
  </script>
  <script>
    let windowHeight = $(window).height();
    $(".nav-item").css("min-height", windowHeight - 70 + "px");
    $(".main-item").css("min-height", windowHeight - 70 + "px");  
  </script>

  <script>
    $(document).ready(function () {
      $.ajax({
        url: `/category`,
        type: "GET",
        success: (response) => {
          let listSelect = response?.data?.rows.map(
            (item, index) => `<option value=${item.id}>${item.name}</option>`
          );
          $("#categoryId")[0].innerHTML = listSelect;
        },
        error: (data) => {
          Toastify({
            text: data.responseJSON.errorCode,
            duration: 2000,
            destination: "http://localhost:3000/",
            newWindow: true,
            //close: true,
            offset: {
              x: 50, // horizontal axis - can be a number or a string indicating unity. eg: '2em'
              y: 10, // vertical axis - can be a number or a string indicating unity. eg: '2em'
            },
            gravity: "top", // `top` or `bottom`
            position: "right", // `left`, `center` or `right`
            stopOnFocus: true, // Prevents dismissing of toast on hover
            style: {
              background: "linear-gradient(to right, red, red)",
              width: "250px",
              fontSize: "16px",
            },
            onClick: function () {}, // Callback after click
          }).showToast();
        },
      });

      $("#HandleSubmitForm").submit((e) => {
        e.preventDefault();
        // const data = $("#HandleSubmitForm").serialize();
        let form = document.getElementById("HandleSubmitForm");
        let formData = new FormData(form);

        $.ajax({
          url: "/product",
          type: "POST",
          data: formData,
          processData: false,
          contentType: false,
          success: function (data) {
            Toastify({
              text: "Thêm sách thành công",
              duration: 2000,
              newWindow: true,
              //close: true,
              offset: {
                x: 50, // horizontal axis - can be a number or a string indicating unity. eg: '2em'
                y: 10, // vertical axis - can be a number or a string indicating unity. eg: '2em'
              },
              gravity: "top", // `top` or `bottom`
              position: "right", // `left`, `center` or `right`
              stopOnFocus: true, // Prevents dismissing of toast on hover
              style: {
                background: "linear-gradient(to right, green, green)",
                width: "250px",
                fontSize: "16px",
              },
              onClick: function () {}, // Callback after click
            }).showToast();
          },
          error: function (xhr, textStatus, errorThrown) {
            Toastify({
              text: "Thêm sách không thành công",
              duration: 2000,
              destination: "http://localhost:3000/",
              newWindow: true,
              //close: true,
              offset: {
                x: 50, // horizontal axis - can be a number or a string indicating unity. eg: '2em'
                y: 10, // vertical axis - can be a number or a string indicating unity. eg: '2em'
              },
              gravity: "top", // `top` or `bottom`
              position: "right", // `left`, `center` or `right`
              stopOnFocus: true, // Prevents dismissing of toast on hover
              style: {
                background: "linear-gradient(to right, red, red)",
                width: "250px",
                fontSize: "16px",
              },
              onClick: function () {}, // Callback after click
            }).showToast();
          },
        });
      });
    });
  </script>

</html>
